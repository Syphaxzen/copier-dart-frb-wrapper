import 'package:test/test.dart';
import 'package:{{ package_name }}/{{ package_name }}.dart';

void main() {
  group('{{ package_name | to_camel }}', () {
    // =========================================================================
    // Initialization tests
    // =========================================================================
    group('initialization', () {
      // Ensure clean state after each test
      tearDown({{ package_name | to_camel }}.cleanup);

      test('initializes successfully', () async {
        await {{ package_name | to_camel }}.init();
        expect({{ package_name | to_camel }}.isInitialized, isTrue);
      });

      test('multiple init calls are idempotent', () async {
        await {{ package_name | to_camel }}.init();
        await {{ package_name | to_camel }}.init();
        expect({{ package_name | to_camel }}.isInitialized, isTrue);
      });

      test('cleanup resets initialization state', () async {
        await {{ package_name | to_camel }}.init();
        {{ package_name | to_camel }}.cleanup();
        expect({{ package_name | to_camel }}.isInitialized, isFalse);
      });

      test('cleanup is safe to call when not initialized', () {
        // Should not throw
        {{ package_name | to_camel }}.cleanup();
        expect({{ package_name | to_camel }}.isInitialized, isFalse);
      });

      test('can reinitialize after cleanup', () async {
        await {{ package_name | to_camel }}.init();
        {{ package_name | to_camel }}.cleanup();
        await {{ package_name | to_camel }}.init();
        expect({{ package_name | to_camel }}.isInitialized, isTrue);
      });
    });

    // =========================================================================
    // Guard tests
    // =========================================================================
    group('ensureInitialized', () {
      test('throws StateError when not initialized', () {
        {{ package_name | to_camel }}.cleanup();
        expect({{ package_name | to_camel }}.ensureInitialized, throwsStateError);
      });

      test('does not throw when initialized', () async {
        await {{ package_name | to_camel }}.init();
        // Should not throw
        expect({{ package_name | to_camel }}.ensureInitialized, returnsNormally);
        {{ package_name | to_camel }}.cleanup();
      });
    });

  });

  // ===========================================================================
  // Add more test groups for your library's functionality below
  // ===========================================================================
  //
  // Recommended test structure:
  // - test/{{ package_name }}_test.dart - Basic initialization and version tests (this file)
  // - test/utils_test.dart - Utility function tests
  // - test/<feature>_test.dart - Feature-specific tests
  //
  // Example test group structure:
  //
  // group('MyFeature', () {
  //   setUpAll({{ package_name | to_camel }}.init);
  //   tearDownAll({{ package_name | to_camel }}.cleanup);
  //
  //   test('feature does something', () {
  //     // Your test here
  //   });
  // });
}
